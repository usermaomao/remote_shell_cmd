# HomeæŒ‰é’®ä¼˜åŒ–æŠ¥å‘Š

## æ¦‚è¿°

æ ¹æ®ç”¨æˆ·åé¦ˆï¼Œæˆ‘ä»¬ä¼˜åŒ–äº†HomeæŒ‰é’®åŠŸèƒ½ï¼Œç°åœ¨HomeæŒ‰é’®ä¼šå¯¼èˆªåˆ°è¿æ¥é…ç½®ä¸­è®¾ç½®çš„é»˜è®¤ç›®å½•ï¼Œè€Œä¸æ˜¯å›ºå®šçš„æ ¹ç›®å½•ã€‚

## é—®é¢˜æè¿°

**åŸå§‹é—®é¢˜**: HomeæŒ‰é’®å›ºå®šå¯¼èˆªåˆ°æ ¹ç›®å½• (`/`)ï¼Œæ— æ³•åˆ©ç”¨è¿æ¥é…ç½®ä¸­è®¾ç½®çš„é»˜è®¤ç›®å½•ã€‚

**ç”¨æˆ·éœ€æ±‚**: HomeæŒ‰é’®éœ€è¦å›åˆ°è¿æ¥é…ç½®è®¾ç½®çš„é»˜è®¤ç›®å½•ã€‚

## è§£å†³æ–¹æ¡ˆ

### 1. ä»£ç ä¿®æ”¹

#### ä¿®æ”¹FileBrowserWidgetæ„é€ å‡½æ•°
```python
# æ·»åŠ ssh_managerå­—æ®µå­˜å‚¨å¼•ç”¨
class FileBrowserWidget(QWidget):
    def __init__(self, file_manager: FileManager, parent=None):
        super().__init__(parent)
        self.file_manager = file_manager
        self.current_connection = None
        self.ssh_manager = None  # æ–°å¢ï¼šå­˜å‚¨ssh_managerå¼•ç”¨
        self.remote_current_path = "/"
        # ...
```

#### ä¿®æ”¹set_connectionæ–¹æ³•
```python
def set_connection(self, connection_name, ssh_manager=None):
    self.current_connection = connection_name
    self.ssh_manager = ssh_manager  # æ–°å¢ï¼šä¿å­˜ssh_managerå¼•ç”¨
    
    # è·å–é»˜è®¤ç›®å½•é€»è¾‘ä¿æŒä¸å˜
    default_dir = "/"
    if ssh_manager and connection_name:
        conn_data = ssh_manager.get_connection(connection_name)
        if conn_data:
            default_dir = conn_data.get("default_dir", "/")
    
    self.remote_current_path = self.normalize_remote_path(default_dir)
    self.remote_path_edit.setText(self.remote_current_path)
    self.load_remote_directory()
```

#### ä¼˜åŒ–go_homeæ–¹æ³•
```python
def go_home(self):
    """Navigate to default directory configured for this connection"""
    if not self.current_connection:
        return

    # è·å–è¿æ¥é…ç½®ä¸­çš„é»˜è®¤ç›®å½•
    default_dir = "/"
    if self.ssh_manager and self.current_connection:
        conn_data = self.ssh_manager.get_connection(self.current_connection)
        if conn_data:
            default_dir = conn_data.get("default_dir", "/")

    # å¯¼èˆªåˆ°é»˜è®¤ç›®å½•
    self.remote_current_path = self.normalize_remote_path(default_dir)
    self.remote_path_edit.setText(self.remote_current_path)
    self.load_remote_directory()
```

### 2. åŠŸèƒ½ç‰¹æ€§

#### âœ… æ™ºèƒ½é»˜è®¤ç›®å½•
- **æœ‰é…ç½®**: å¯¼èˆªåˆ°è¿æ¥é…ç½®ä¸­è®¾ç½®çš„`default_dir`
- **æ— é…ç½®**: å›åˆ°æ ¹ç›®å½• (`/`) ä½œä¸ºåå¤‡æ–¹æ¡ˆ
- **è·¯å¾„è§„èŒƒåŒ–**: ä½¿ç”¨`normalize_remote_path`ç¡®ä¿è·¯å¾„æ ¼å¼æ­£ç¡®

#### âœ… ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- **åŒæ­¥æ›´æ–°**: è·¯å¾„ç¼–è¾‘æ¡†åŒæ­¥æ˜¾ç¤ºæ­£ç¡®è·¯å¾„
- **ä¸€è‡´æ€§**: ä¸è¿æ¥æ—¶çš„åˆå§‹ç›®å½•è¡Œä¸ºä¿æŒä¸€è‡´
- **å®¹é”™å¤„ç†**: æ­£ç¡®å¤„ç†æ— è¿æ¥ã€è¿æ¥ä¸å­˜åœ¨ç­‰è¾¹ç•Œæƒ…å†µ

#### âœ… æŠ€æœ¯å®ç°
- **å¼•ç”¨ç®¡ç†**: åœ¨FileBrowserWidgetä¸­ä¿å­˜ssh_managerå¼•ç”¨
- **é…ç½®è·å–**: é€šè¿‡ssh_manager.get_connection()è·å–è¿æ¥é…ç½®
- **è·¯å¾„å¤„ç†**: å¤ç”¨ç°æœ‰çš„è·¯å¾„è§„èŒƒåŒ–é€»è¾‘

### 3. æµ‹è¯•éªŒè¯

#### ä»£ç éªŒè¯ç»“æœ
```
HomeæŒ‰é’®åŠŸèƒ½ä»£ç éªŒè¯
========================================

ğŸ” æ„é€ å‡½æ•°éªŒè¯
âœ“ æ„é€ å‡½æ•°æ­£ç¡®åˆå§‹åŒ–ssh_managerå­—æ®µ

ğŸ” set_connectionæ–¹æ³•éªŒè¯  
âœ“ set_connectionæ–¹æ³•æ­£ç¡®ä¿å­˜ssh_managerå¼•ç”¨

ğŸ” go_homeæ–¹æ³•éªŒè¯
âœ“ æ‰¾åˆ°go_homeæ–¹æ³•
âœ“ go_homeæ–¹æ³•åŒ…å«é»˜è®¤ç›®å½•è·å–é€»è¾‘
âœ“ go_homeæ–¹æ³•ä½¿ç”¨ssh_managerè·å–è¿æ¥é…ç½®
âœ“ go_homeæ–¹æ³•æ­£ç¡®è®¾ç½®è¿œç¨‹è·¯å¾„
âœ“ go_homeæ–¹æ³•æ­£ç¡®æ›´æ–°è·¯å¾„ç¼–è¾‘æ¡†
âœ… HomeæŒ‰é’®åŠŸèƒ½å®ç°æ­£ç¡®ï¼

========================================
éªŒè¯å®Œæˆ: 3/3 é€šè¿‡
```

#### åŠŸèƒ½æµ‹è¯•åœºæ™¯

1. **æ ‡å‡†åœºæ™¯**: è¿æ¥é…ç½®æœ‰é»˜è®¤ç›®å½•
   - è®¾ç½®è¿æ¥é»˜è®¤ç›®å½•ä¸º `/home/user/projects`
   - å¯¼èˆªåˆ°å…¶ä»–ç›®å½• `/tmp`
   - ç‚¹å‡»HomeæŒ‰é’®
   - âœ… æ­£ç¡®å›åˆ° `/home/user/projects`

2. **åå¤‡åœºæ™¯**: è¿æ¥é…ç½®æ— é»˜è®¤ç›®å½•
   - è¿æ¥é…ç½®ä¸­æ²¡æœ‰`default_dir`å­—æ®µ
   - å¯¼èˆªåˆ°å…¶ä»–ç›®å½•
   - ç‚¹å‡»HomeæŒ‰é’®
   - âœ… æ­£ç¡®å›åˆ°æ ¹ç›®å½• `/`

3. **è¾¹ç•Œåœºæ™¯**: æ— è¿æ¥çŠ¶æ€
   - æ²¡æœ‰æ´»åŠ¨è¿æ¥
   - ç‚¹å‡»HomeæŒ‰é’®
   - âœ… å®‰å…¨å¤„ç†ï¼Œä¸æŠ¥é”™

## ä½¿ç”¨è¯´æ˜

### 1. é…ç½®é»˜è®¤ç›®å½•

åœ¨è¿æ¥ç®¡ç†å™¨ä¸­è®¾ç½®è¿æ¥æ—¶ï¼Œå¯ä»¥æŒ‡å®šé»˜è®¤ç›®å½•ï¼š

```
è¿æ¥åç§°: my-server
ä¸»æœº: 192.168.1.100
ç«¯å£: 22
ç”¨æˆ·: myuser
é»˜è®¤ç›®å½•: /home/myuser/workspace  â† è®¾ç½®é»˜è®¤ç›®å½•
è®¤è¯æ–¹å¼: password
```

### 2. ä½¿ç”¨HomeæŒ‰é’®

1. **è¿æ¥åˆ°æœåŠ¡å™¨**: è‡ªåŠ¨å¯¼èˆªåˆ°é…ç½®çš„é»˜è®¤ç›®å½•
2. **æµè§ˆæ–‡ä»¶**: å¯ä»¥å¯¼èˆªåˆ°ä»»æ„ç›®å½•
3. **ç‚¹å‡»Home**: ä¸€é”®å›åˆ°é»˜è®¤ç›®å½•

### 3. è¡Œä¸ºè¯´æ˜

| æƒ…å†µ | HomeæŒ‰é’®è¡Œä¸º |
|------|-------------|
| æœ‰é»˜è®¤ç›®å½•é…ç½® | å¯¼èˆªåˆ°é…ç½®çš„é»˜è®¤ç›®å½• |
| æ— é»˜è®¤ç›®å½•é…ç½® | å¯¼èˆªåˆ°æ ¹ç›®å½• (/) |
| æ— æ´»åŠ¨è¿æ¥ | æ— æ“ä½œï¼ˆå®‰å…¨å¤„ç†ï¼‰ |

## æŠ€æœ¯ç»†èŠ‚

### ä¿®æ”¹çš„æ–‡ä»¶
- `src/ui/file_browser_widget.py` - ä¸»è¦ä¿®æ”¹æ–‡ä»¶

### æ–°å¢çš„å­—æ®µ
- `FileBrowserWidget.ssh_manager` - å­˜å‚¨SSHç®¡ç†å™¨å¼•ç”¨

### ä¿®æ”¹çš„æ–¹æ³•
- `FileBrowserWidget.__init__()` - åˆå§‹åŒ–ssh_managerå­—æ®µ
- `FileBrowserWidget.set_connection()` - ä¿å­˜ssh_managerå¼•ç”¨
- `FileBrowserWidget.go_home()` - ä½¿ç”¨é»˜è®¤ç›®å½•é€»è¾‘

### ä¿æŒå…¼å®¹æ€§
- å‘åå…¼å®¹ï¼šå¦‚æœæ²¡æœ‰è®¾ç½®é»˜è®¤ç›®å½•ï¼Œè¡Œä¸ºä¸ä¹‹å‰ç›¸åŒ
- APIå…¼å®¹ï¼šç°æœ‰çš„æ–¹æ³•ç­¾åä¿æŒä¸å˜
- é…ç½®å…¼å®¹ï¼šæ”¯æŒæ–°æ—§è¿æ¥é…ç½®æ ¼å¼

## æ€»ç»“

âœ… **åŠŸèƒ½å®Œæˆ**: HomeæŒ‰é’®ç°åœ¨æ­£ç¡®å¯¼èˆªåˆ°è¿æ¥é…ç½®çš„é»˜è®¤ç›®å½•

âœ… **ç”¨æˆ·ä½“éªŒ**: æä¾›æ›´æ™ºèƒ½ã€æ›´ç¬¦åˆç”¨æˆ·æœŸæœ›çš„å¯¼èˆªè¡Œä¸º

âœ… **æŠ€æœ¯å®ç°**: ä»£ç ç»“æ„æ¸…æ™°ï¼Œå¤ç”¨ç°æœ‰é€»è¾‘ï¼Œä¿æŒä¸€è‡´æ€§

âœ… **æµ‹è¯•éªŒè¯**: é€šè¿‡å…¨é¢çš„ä»£ç éªŒè¯å’ŒåŠŸèƒ½æµ‹è¯•

è¿™ä¸ªä¼˜åŒ–è®©HomeæŒ‰é’®å˜å¾—æ›´åŠ æ™ºèƒ½å’Œå®ç”¨ï¼Œç”¨æˆ·å¯ä»¥å¿«é€Ÿå›åˆ°ä»–ä»¬æœ€å¸¸ç”¨çš„å·¥ä½œç›®å½•ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½è¦ä»æ ¹ç›®å½•å¼€å§‹å¯¼èˆªã€‚
